<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FactCheck Panel</title>
    <style>
      :root {
        /* Colors - Light Mode */
        --bg: #ffffff;
        --bg-secondary: #f8f9fa;
        --fg: #1a1a1a;
        --fg-secondary: #6b7280;
        --muted: #9ca3af;
        --border: #e5e7eb;
        --accent: #3b82f6;
        --accent-light: #eff6ff;
        --good: #059669;
        --good-light: #ecfdf5;
        --warn: #d97706;
        --warn-light: #fffbeb;
        --bad: #dc2626;
        --bad-light: #fef2f2;
        --link: #3b82f6;
        --link-hover: #1d4ed8;

        /* Spacing */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.5rem;
        --space-6: 2rem;

        /* Radii */
        --radius-sm: 0.375rem;
        --radius-md: 0.5rem;
        --radius-lg: 0.75rem;

        /* Typography */
        --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        --font-size-xs: 0.75rem;
        --font-size-sm: 0.875rem;
        --font-size-base: 1rem;
        --font-size-lg: 1.125rem;
        --line-height-tight: 1.25;
        --line-height-normal: 1.5;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #111827;
          --bg-secondary: #1f2937;
          --fg: #f9fafb;
          --fg-secondary: #d1d5db;
          --muted: #6b7280;
          --border: #374151;
          --accent: #60a5fa;
          --accent-light: #1e3a8a;
          --good: #34d399;
          --good-light: #064e3b;
          --warn: #fbbf24;
          --warn-light: #78350f;
          --bad: #f87171;
          --bad-light: #7f1d1d;
          --link: #60a5fa;
          --link-hover: #93c5fd;
        }
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: var(--font-sans);
        font-size: var(--font-size-sm);
        line-height: var(--line-height-normal);
        color: var(--fg);
        background: var(--bg);
        overflow-x: hidden;
      }

      #sp-root {
        width: 100%;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Header */
      #sp-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-4);
        border-bottom: 1px solid var(--border);
        background: var(--bg);
        position: sticky;
        top: 0;
        z-index: 10;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .app-title {
        font-weight: 600;
        font-size: var(--font-size-base);
        color: var(--fg);
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--good);
      }

      .close-btn {
        background: none;
        border: none;
        padding: var(--space-1);
        border-radius: var(--radius-sm);
        cursor: pointer;
        color: var(--fg-secondary);
        transition: background-color 0.15s ease;
      }

      .close-btn:hover {
        background: var(--bg-secondary);
      }

      .close-btn:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      /* Main Content */
      .content {
        flex: 1;
        padding: var(--space-4);
        display: flex;
        flex-direction: column;
        gap: var(--space-5);
      }

      /* Selection Preview */
      #sp-selection {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        padding: var(--space-4);
      }

      .selection-content {
        color: var(--fg-secondary);
        font-size: var(--font-size-sm);
        line-height: var(--line-height-normal);
        margin-bottom: var(--space-3);
      }

      .selection-content.collapsed {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .toggle-btn {
        background: none;
        border: none;
        color: var(--link);
        cursor: pointer;
        font-size: var(--font-size-sm);
        padding: 0;
        text-decoration: underline;
      }

      .toggle-btn:hover {
        color: var(--link-hover);
      }

      .toggle-btn:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
        border-radius: var(--radius-sm);
      }

      /* Classification */
      #sp-classification {
        text-align: center;
      }

      .classification-badge {
        display: inline-flex;
        align-items: center;
        padding: var(--space-3) var(--space-5);
        border-radius: var(--radius-lg);
        font-weight: 600;
        font-size: var(--font-size-base);
        text-transform: uppercase;
        letter-spacing: 0.025em;
      }

      .classification-badge[data-type="opinion"] {
        background: var(--accent-light);
        color: var(--accent);
        border: 1px solid var(--accent);
      }

      .classification-badge[data-type="statement"] {
        background: var(--accent-light);
        color: var(--accent);
        border: 1px solid var(--accent);
      }

      /* Categories */
      #sp-categories {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }

      .chip {
        display: inline-flex;
        align-items: center;
        padding: var(--space-1) var(--space-3);
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        font-size: var(--font-size-xs);
        color: var(--fg-secondary);
        font-weight: 500;
      }

      /* Credibility */
      #sp-credibility {
        padding: var(--space-4);
        border-radius: var(--radius-md);
        border: 1px solid;
      }

      #sp-credibility[data-level="high"] {
        background: var(--good-light);
        border-color: var(--good);
        color: var(--good);
      }

      #sp-credibility[data-level="medium"] {
        background: var(--warn-light);
        border-color: var(--warn);
        color: var(--warn);
      }

      #sp-credibility[data-level="low"] {
        background: var(--bad-light);
        border-color: var(--bad);
        color: var(--bad);
      }

      .credibility-level {
        font-weight: 600;
        font-size: var(--font-size-sm);
        margin-bottom: var(--space-1);
        text-transform: uppercase;
        letter-spacing: 0.025em;
      }

      .credibility-rationale {
        font-size: var(--font-size-sm);
        opacity: 0.9;
      }

      /* Sources */
      #sp-sources {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
      }

      .section-title {
        font-weight: 600;
        color: var(--fg);
        margin-bottom: var(--space-3);
      }

      .source-card {
        display: block;
        text-decoration: none;
        padding: var(--space-4);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        background: var(--bg);
        transition: all 0.15s ease;
        color: inherit;
      }

      .source-card:hover {
        border-color: var(--accent);
        background: var(--bg-secondary);
      }

      .source-card:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      .source-header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: var(--space-2);
        margin-bottom: var(--space-2);
      }

      .source-title {
        font-weight: 600;
        font-size: var(--font-size-sm);
        color: var(--fg);
        line-height: var(--line-height-tight);
      }

      .external-icon {
        flex-shrink: 0;
        color: var(--muted);
        margin-top: var(--space-1);
      }

      .source-domain {
        font-size: var(--font-size-xs);
        color: var(--muted);
        margin-bottom: var(--space-2);
      }

      .source-snippet {
        font-size: var(--font-size-sm);
        color: var(--fg-secondary);
        line-height: var(--line-height-normal);
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      /* Footer */
      #sp-footer {
        padding: var(--space-4);
        border-top: 1px solid var(--border);
        background: var(--bg);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: var(--space-3);
      }

      .footer-actions {
        display: flex;
        gap: var(--space-2);
      }

      .action-btn {
        display: flex;
        align-items: center;
        gap: var(--space-1);
        padding: var(--space-2) var(--space-3);
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        font-size: var(--font-size-xs);
        color: var(--fg-secondary);
        cursor: pointer;
        transition: all 0.15s ease;
        text-decoration: none;
      }

      .action-btn:hover {
        background: var(--accent-light);
        border-color: var(--accent);
        color: var(--accent);
      }

      .action-btn:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      .settings-btn {
        background: none;
        border: none;
        padding: var(--space-2);
        border-radius: var(--radius-sm);
        cursor: pointer;
        color: var(--fg-secondary);
        transition: background-color 0.15s ease;
      }

      .settings-btn:hover {
        background: var(--bg-secondary);
      }

      .settings-btn:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      /* Loading States */
      #sp-root[data-state="loading"] .skeleton {
        background: linear-gradient(
          90deg,
          var(--bg-secondary) 25%,
          var(--border) 50%,
          var(--bg-secondary) 75%
        );
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s infinite;
        border-radius: var(--radius-sm);
      }

      @keyframes skeleton-loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      .skeleton-badge {
        height: 40px;
        width: 120px;
        margin: 0 auto;
      }

      .skeleton-chip {
        height: 24px;
        width: 80px;
      }

      .skeleton-source {
        height: 100px;
        width: 100%;
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: var(--space-6);
        color: var(--fg-secondary);
      }

      .empty-state h3 {
        margin: 0 0 var(--space-2) 0;
        color: var(--fg);
      }

      .retry-btn {
        margin-top: var(--space-3);
        color: var(--link);
        background: none;
        border: none;
        cursor: pointer;
        text-decoration: underline;
      }

      .retry-btn:hover {
        color: var(--link-hover);
      }

      /* Error State */
      .error-alert {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-3);
        background: var(--bad-light);
        border: 1px solid var(--bad);
        border-radius: var(--radius-md);
        color: var(--bad);
        font-size: var(--font-size-sm);
      }

      /* Responsive adjustments */
      @media (max-width: 360px) {
        .content {
          padding: var(--space-3);
          gap: var(--space-4);
        }

        #sp-header {
          padding: var(--space-3);
        }

        #sp-footer {
          padding: var(--space-3);
          flex-direction: column;
          gap: var(--space-2);
        }

        .footer-actions {
          width: 100%;
          justify-content: center;
        }
      }

      /* Reduced motion */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Hide elements based on state */
      #sp-root[data-state="loading"] .ready-content {
        display: none;
      }
      #sp-root[data-state="ready"] .loading-content {
        display: none;
      }
      #sp-root[data-state="ready"] .empty-content {
        display: none;
      }
      #sp-root[data-state="ready"] .error-content {
        display: none;
      }
      #sp-root[data-state="empty"] .ready-content {
        display: none;
      }
      #sp-root[data-state="empty"] .loading-content {
        display: none;
      }
      #sp-root[data-state="empty"] .error-content {
        display: none;
      }
      #sp-root[data-state="error"] .ready-content {
        display: none;
      }
      #sp-root[data-state="error"] .loading-content {
        display: none;
      }
      #sp-root[data-state="error"] .empty-content {
        display: none;
      }

      /* Hide credibility for opinion */
      #sp-root[data-classification="opinion"] #sp-credibility {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="sp-root" data-state="ready" data-classification="statement">
      <!-- Header -->
      <header id="sp-header">
        <div class="header-left">
          <h1 class="app-title">FactCheck</h1>
          <div class="status-dot" title="Connected"></div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="content">
        <!-- Selection Preview -->
        <section id="sp-selection">
          <div class="selection-content collapsed" id="selection-text">
            Climate change is a hoax perpetrated by scientists to get more
            funding for their research. The data has been manipulated and the
            models are unreliable. Natural climate variations explain all
            observed changes, and human activities have negligible impact on
            global temperatures.
          </div>
        </section>

        <!-- Loading Content -->
        <div class="loading-content">
          <div id="sp-classification">
            <div class="skeleton skeleton-badge"></div>
          </div>

          <div id="sp-categories">
            <div class="skeleton skeleton-chip"></div>
            <div class="skeleton skeleton-chip"></div>
            <div class="skeleton skeleton-chip"></div>
          </div>

          <div id="sp-sources">
            <h2 class="section-title">Related Sources</h2>
            <div class="skeleton skeleton-source"></div>
            <div class="skeleton skeleton-source"></div>
            <div class="skeleton skeleton-source"></div>
          </div>
        </div>

        <!-- Ready Content -->
        <div class="ready-content">
          <!-- Classification -->
          <section id="sp-classification">
            <div class="classification-badge" data-type="statement">
              Statement
            </div>
            <!-- For Opinion: <div class="classification-badge" data-type="opinion">Opinion</div> -->
          </section>

          <!-- Categories -->
          <section id="sp-categories">
            <span class="chip">Climate Science</span>
            <span class="chip">Environmental Policy</span>
            <span class="chip">Scientific Research</span>
          </section>

          <!-- Credibility (only for statements) -->
          <section id="sp-credibility" data-level="low">
            <div class="credibility-level">Low Credibility</div>
            <div class="credibility-rationale">
              Contradicted by overwhelming scientific consensus
            </div>
          </section>

          <!-- Related Sources -->
          <section id="sp-sources">
            <h2 class="section-title">Related Sources</h2>

            <a href="#" class="source-card" target="_blank" rel="noopener">
              <div class="source-header">
                <h3 class="source-title">
                  Climate Change: Evidence and Scientific Consensus
                </h3>
                <svg
                  class="external-icon"
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="currentColor"
                >
                  <path
                    d="M3.5 3c-.28 0-.5.22-.5.5s.22.5.5.5h3.086L2.793 7.793a.5.5 0 1 0 .707.707L7.293 4.707V7.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5h-4z"
                  />
                </svg>
              </div>
              <div class="source-domain">nature.com</div>
              <p class="source-snippet">
                Multiple lines of evidence confirm that human activities are the
                primary driver of recent climate change, with over 97%
                scientific consensus.
              </p>
            </a>

            <a href="#" class="source-card" target="_blank" rel="noopener">
              <div class="source-header">
                <h3 class="source-title">IPCC Sixth Assessment Report</h3>
                <svg
                  class="external-icon"
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="currentColor"
                >
                  <path
                    d="M3.5 3c-.28 0-.5.22-.5.5s.22.5.5.5h3.086L2.793 7.793a.5.5 0 1 0 .707.707L7.293 4.707V7.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5h-4z"
                  />
                </svg>
              </div>
              <div class="source-domain">ipcc.ch</div>
              <p class="source-snippet">
                Comprehensive assessment shows unequivocal evidence that human
                influence has warmed the planet at a rate unprecedented in at
                least 2000 years.
              </p>
            </a>

            <a href="#" class="source-card" target="_blank" rel="noopener">
              <div class="source-header">
                <h3 class="source-title">
                  NASA Global Climate Change and Global Warming
                </h3>
                <svg
                  class="external-icon"
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="currentColor"
                >
                  <path
                    d="M3.5 3c-.28 0-.5.22-.5.5s.22.5.5.5h3.086L2.793 7.793a.5.5 0 1 0 .707.707L7.293 4.707V7.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5h-4z"
                  />
                </svg>
              </div>
              <div class="source-domain">nasa.gov</div>
              <p class="source-snippet">
                Current warming trend is of particular significance because most
                of it is extremely likely due to human activity since the
                mid-20th century.
              </p>
            </a>
          </section>
        </div>

        <!-- Empty State -->
        <div class="empty-content">
          <div class="empty-state">
            <h3>No related sources found</h3>
            <p>We couldn't find any relevant sources for this selection.</p>
            <button class="retry-btn" type="button" onclick="retry()">
              Retry
            </button>
          </div>
        </div>

        <!-- Error State -->
        <div class="error-content">
          <div class="error-alert">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path
                d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
              />
              <path
                d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"
              />
            </svg>
            <span>Failed to analyze selection. Please try again.</span>
            <button class="retry-btn" type="button" onclick="retry()">
              Retry
            </button>
          </div>
        </div>
      </main>

      <!-- Footer -->
      <footer id="sp-footer">
        <div class="footer-actions">
          <button class="action-btn" type="button">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path
                d="M4 1.5H3a2 2 0 0 0-2 2V9a2 2 0 0 0 2 2h3.5a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-1 0V9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1a.5.5 0 0 0 0-1z"
              />
              <path
                d="M8.5 1a.5.5 0 0 0-.5.5v1.293L6.146 4.646a.5.5 0 1 0 .708.708L8.707 3.5H10a.5.5 0 0 0 0-1H8.5z"
              />
            </svg>
            Copy
          </button>
          <button class="action-btn" type="button">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path
                d="M6 1a.5.5 0 0 1 .5.5V5h3a.5.5 0 0 1 0 1H6.5v3.5a.5.5 0 0 1-1 0V6H2a.5.5 0 0 1 0-1h3.5V1.5A.5.5 0 0 1 6 1z"
              />
            </svg>
            Save
          </button>
        </div>
        <button
          class="settings-btn"
          type="button"
          aria-label="Settings"
          title="Settings"
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path
              d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"
            />
          </svg>
        </button>
      </footer>
    </div>

    <script>
      // Toggle selection preview
      function toggleSelection() {
        const content = document.getElementById("selection-text");
        const button = document.querySelector(".toggle-btn");

        if (content.classList.contains("collapsed")) {
          content.classList.remove("collapsed");
          button.textContent = "Show less";
        } else {
          content.classList.add("collapsed");
          button.textContent = "Show more";
        }
      }

      // Retry function
      function retry() {
        const root = document.getElementById("sp-root");
        root.setAttribute("data-state", "loading");

        // Simulate loading and return to ready state
        setTimeout(() => {
          root.setAttribute("data-state", "ready");
        }, 2000);
      }

      // Demo: Switch between states (for testing)
      function switchState(state) {
        document.getElementById("sp-root").setAttribute("data-state", state);
      }

      // Demo: Switch between opinion and statement (for testing)
      function switchClassification(type) {
        const root = document.getElementById("sp-root");
        root.setAttribute("data-classification", type);

        const badge = document.querySelector(".classification-badge");
        badge.setAttribute("data-type", type);
        badge.textContent = type === "opinion" ? "Opinion" : "Statement";
      }

      // Keyboard navigation enhancements
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          // Close panel or handle escape
          console.log("Escape pressed - would close panel");
        }
      });

      // Handle button press states
      document.addEventListener("click", function (e) {
        if (e.target.matches("button, .action-btn")) {
          e.target.style.transform = "scale(0.95)";
          setTimeout(() => {
            e.target.style.transform = "";
          }, 100);
        }
      });

      // Initialize panel
      document.addEventListener("DOMContentLoaded", function () {
        // Set initial state
        const root = document.getElementById("sp-root");
        root.setAttribute("data-state", "ready");
        root.setAttribute("data-classification", "statement");
      });
    </script>
    <script src="sidepanel.js"></script>
  </body>
</html>
